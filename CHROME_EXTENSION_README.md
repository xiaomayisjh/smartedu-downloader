# 智慧教育PDF下载器 - Chrome插件

这是一个Chrome浏览器插件，用于在智慧教育平台教材页面自动提取并下载PDF文件。

## 功能特点

✅ **自动检测** - 在智慧教育教材页面自动检测PDF文件  
✅ **一键下载** - 点击按钮即可下载PDF文件  
✅ **认证支持** - 自动处理X-ND-AUTH认证头  
✅ **进度显示** - 实时显示下载进度  
✅ **错误处理** - 完善的错误提示和处理  
✅ **美观界面** - 现代化的用户界面  

## 安装方法

### 方法1：开发者模式安装（推荐）

1. 打开Chrome浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择此插件文件夹
6. 插件安装完成

### 方法2：打包安装

1. 在开发者模式下点击"打包扩展程序"
2. 选择插件文件夹生成.crx文件
3. 拖拽.crx文件到扩展程序页面安装

## 使用方法

### 基本使用

1. 访问智慧教育平台：`https://basic.smartedu.cn/`
2. 登录你的账号
3. 进入教材详情页面（URL包含`tchMaterial/detail`）
4. 等待页面加载完成
5. 点击插件图标或页面上的下载按钮
6. 开始下载PDF文件

### 插件界面

- **插件图标**：点击可打开插件弹出页面
- **下载按钮**：页面右上角会显示下载按钮
- **状态提示**：实时显示检测和下载状态

## 文件结构

```
smartedu-downloader/
├── manifest.json          # 插件配置文件
├── background.js          # 后台脚本
├── content.js            # 内容脚本
├── popup.html            # 弹出页面HTML
├── popup.css             # 弹出页面样式
├── popup.js              # 弹出页面脚本
├── icons/                # 插件图标目录
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   ├── icon128.png
│   └── README.md
└── CHROME_EXTENSION_README.md
```

## 工作原理

1. **页面检测**：内容脚本在教材页面注入，检测PDF iframe
2. **信息提取**：从iframe的src属性中提取文件URL和认证信息
3. **下载处理**：后台脚本使用Chrome下载API处理文件下载
4. **用户界面**：弹出页面提供友好的操作界面

## 技术细节

### 支持的页面
- URL模式：`https://basic.smartedu.cn/tchMaterial/detail*`
- 检测元素：XPath `/html/body/div[1]/div/div/div[3]/div[5]/div/div/div/div[3]/div/div/div/div/div/iframe`

### 权限说明
- `activeTab`：访问当前活动标签页
- `downloads`：下载文件
- `storage`：存储插件数据
- `scripting`：注入脚本
- `host_permissions`：访问智慧教育域名

### 认证处理
- 自动解析X-ND-AUTH认证头
- 支持MAC认证方式
- 保持会话状态

## 故障排除

### 常见问题

**Q: 插件无法检测到PDF文件**
A: 确保：
- 在正确的教材页面（URL包含tchMaterial/detail）
- 已登录智慧教育账号
- 页面完全加载完成
- 点击刷新按钮重新检测

**Q: 下载失败**
A: 可能原因：
- 认证信息过期，需要重新登录
- 网络连接问题
- 文件权限不足

**Q: 插件图标不显示**
A: 检查icons目录是否包含所需尺寸的图标文件

### 调试方法

1. 打开Chrome开发者工具（F12）
2. 查看Console标签页的错误信息
3. 检查Network标签页的网络请求
4. 在扩展程序页面点击"检查视图"查看插件日志

## 更新日志

### v1.0.0
- 初始版本发布
- 支持PDF文件检测和下载
- 完整的用户界面
- 错误处理和状态提示

## 注意事项

1. **合法使用**：请确保你有权限下载相关教材文件
2. **账号安全**：不要在公共设备上保存登录状态
3. **网络环境**：确保网络连接稳定
4. **浏览器版本**：建议使用Chrome 88+版本

## 技术支持

如果遇到问题，请：
1. 检查浏览器控制台错误信息
2. 确认插件权限设置
3. 尝试重新安装插件
4. 联系技术支持

## 免责声明

本插件仅供学习和研究使用，请遵守相关法律法规和平台使用条款。使用者需自行承担使用风险。
